#assetic:
#    debug: %debug%
#    output: "%root%/static"
#    assets:
#        site_js:
#            output: "static/site.js"
#            input:
#                - "%sf_path%/misc/site.js"

services:
    # assetic
    assets:
        class: Sfcms\Assets

    asset.manager:
        class: Assetic\AssetManager

    asset.filter.manager:
        class: Assetic\FilterManager

    asset.cache_boosting.worker:
        class: Assetic\Factory\Worker\CacheBustingWorker

    asset.factory:
        class: Assetic\Factory\AssetFactory
        arguments: ["%assetic.output%"]
        calls:
            - [setAssetManager, [@asset.manager]]
            - [setFilterManager, [@asset.filter.manager]]
            - [setDebug, [%debug%]]
#            - [addWorker, [@asset.cache_boosting.worker]]

    asset.writer:
        class: Assetic\AssetWriter
        arguments: ["%assetic.output%"]
        calls:
            - [writeManagerAssets, ["@asset.manager"]]

    asset.service:
        class: Module\System\Service\AsseticService
        arguments: ["@asset.factory", "@service_container"]

    smarty.plugin.asset:
        class: Module\System\Plugin\AssetPlugin
        arguments: ["@asset.factory"]
        tags:
            - { name: smarty.plugin, type: function, plugin: style, method: functionStyle }
            - { name: smarty.plugin, type: function, plugin: js, method: functionJs }
