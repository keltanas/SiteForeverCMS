# Smarty #

##Загрузка##

Smarty подключается в качестве сервиса `smarty` и к нему всегда напрямую можно получить доступ из контейнера,
аналогично другим службам.

Но, работа с шаблонами обычно просходит через абстракцию `tpl`.

Для поддержки темизации, сперва модуль, отвечающий за загрузку Smarty регистрирует директорию с шаблонами из вашей темы:
`themes/{my_theme}/templates`. Далее проходит по всем модулям, и подключает директории `View`, если найдет.

Т.о. любой шаблон любого модуля может быть переопределен в директории с темой и изменен, как этого требует проект.

Регистрацией директорий занимается контейнер, содержимое которого кэшируется и на продакшене
никакого сканирования директорий происходить не будет.

##Рендеринг##

Чтобы выполнить шаблон из контроллера и вернуть объект `Response`,
достаточно вызвать метод `$this->render(...)`

    class DefaultController extends Controller
    {
        public function indexAction()
        {
            return $this->render('category.index', array('name'=>'world'));
        }
    }

Заметьте, что шаблон вызывается через alias. Расшифровывается он, как `category/index.tpl`
Точки заменяются на символ иерархии директории, а к файлу добавляется расширение `.tpl`

Содержимое шаблона может быть примерно таким:

    <p>Hello {$name}!</p>

После отрисовки, шаблон превратится в html:

    <p>Hello world!</p>

Еще один способ оработки шаблона - это получить сервис `tpl` и вызвать его метод `fetch(...)`

    $container->get('tpl')->assign('name', 'world');
    $container->get('tpl')->fetch('category.index');

Или в контроллере можно так:

    $this->tpl->assign('name', 'world');
    $this->tpl->fetch('category.index');

##Рекомендации##

В настоящий момент нет способа, чтобы как-то привязать шаблон к конкретному модулю, поэтому,
если положить шаблон `index.tpl` в папку `Module1/View`, и такой же файл в папку `Module2/View`,
то будет использован тот, модуль которого был загружен первым.
Модули загружаются ядром в порядке их регистрации в файле `app/modules.php`.
И этого следует, что вы сами должны позаботится о безопастном пути хранения своих шаблонов. Например:

    Module1
        /View
            /module1
                /index.tpl
    Module2
        /View
            /module2
                /index.tpl

Теперь, каждый из шаблонов может быть вызван в своем именном пространстве:

    $this->render('module1.index');
    $this->render('module2.index');

##[Формы](forms.md)##

Формы также используют Smarty для шаблонизации.

Вызвать отрисовку формы можно следующим способом:

    $form->createView()->html();

В метод `html()` можно передать массив параметров:

    $form->createView()->html([hint=>true, buttons=>true, domain=>"messages", class=>"form-horizontal"]);

>   До версии 0.6 отрисовка вызывалась как `$form->html([hint: true[, buttons: true]])`
